{"type":"pattern","name":"Agent Lifecycle: Sling-Execute-Close","description":"Agent spawn: overstory sling creates worktree + overlay CLAUDE.md + hooks + tmux session. Agent reads base def + overlay, executes task. Agent reports completion via bd close. Worktree cleaned after merge. Branch naming: overstory/{agentName}/{beadId}.","classification":"foundational","recorded_at":"2026-02-12T15:18:28.885Z","tags":["lifecycle","sling","worktree"],"id":"mx-389460"}
{"type":"pattern","name":"State reconciliation in status display","description":"When displaying agent status, reconcile recorded state with actual tmux session existence. If tmux session is dead but agent state is booting/working, mark as zombie and persist the correction to sessions.json. This prevents stale states from misleading the orchestrator.","classification":"tactical","recorded_at":"2026-02-12T16:32:50.002Z","id":"mx-1c2df8"}
{"type":"pattern","name":"PATH injection for tmux-spawned agents","description":"When creating tmux sessions for agents, detect the overstory binary directory via 'which overstory' (or fallback to process.argv[0] dirname) and prepend it to PATH in the tmux command wrapper. This ensures hooks inside agent sessions can find the overstory CLI.","classification":"tactical","recorded_at":"2026-02-12T16:32:55.639Z","id":"mx-2e4365"}
{"type":"pattern","name":"Session lastActivity update in hooks","description":"log.ts tool-start and tool-end events update the agent lastActivity timestamp in sessions.json. session-end calls updateIdentity to increment sessionsCompleted and record completed task. All updates are non-fatal to avoid breaking hook execution.","classification":"tactical","recorded_at":"2026-02-12T16:33:32.203Z","id":"mx-6f17c5"}
